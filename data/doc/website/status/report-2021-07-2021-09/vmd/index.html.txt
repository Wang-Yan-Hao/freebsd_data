[FreeBSD The Power to Serve]

Donate to FreeBSD

 

-   Home

-   About
    -   Introduction
    -   Features
    -   Advocacy
    -   Marketing
    -   Privacy Policy
    -   Projects
    -   Ports

-   Get FreeBSD
    -   Release Information
    -   Release Engineering

-   Documentation
    -   FAQ
    -   Handbook
    -   Porter's Handbook
    -   Developer's Handbook
    -   Committer's Guide
    -   Manual Pages
    -   Presentations and Papers
    -   Documentation Project Primer
    -   All Books and Articles

-   Community
    -   Mailing Lists
    -   Forums
    -   User Groups
    -   Events
    -   FreeBSD Journal
    -   Q&A (external)

-   Developers
    -   Project Ideas
    -   Git Repository
    -   Subversion Repository
    -   GitHub Mirror
    -   Code Review (Phabricator)
    -   Wiki
    -   Continuous Integration Service

-   Support
    -   Vendors
    -   Security Information
    -   Bug Reports
    -   Submitting Bug Reports
<<<<<<< HEAD
=======
    -   Web Resources

-   Foundation
    -   Monetary Donations
    -   Hardware Donations

-   About
-   Features
-   Applications
-   Advocacy
-   Marketing
-   Administration
-   News
-   Events
-   Press
-   Artwork
-   Logo
-   Donations
-   Legal Notices
-   Privacy Policy

Intel Volume Management Device driver update

Links:
main branch commit URL:
https://cgit.freebsd.org/src/commit/?id=7af4475a6e31202a865b1dd3727018659b44470f

Contact: Alexander Motin <mav@FreeBSD.org>

Intel VMD is used by Intel’s VROC (Virtual RAID on chip) to isolate
parts of PCI tree, including NVMe devices, behind one or several VMD
devices. Each VMD device has 3 memory windows to access config space and
memory of its child devices, plus some number (I saw 19 and 33) of MSI-X
interrupt vectors to forward their MSI and MSI-X interrupts through.

The vmd(4) driver was first introduced in FreeBSD 13.0, but was found to
have a number of problems addressed in this update: - The VMD device was
made to look more like a regular PCI-to-PCI bridge, implementing the
regular pcib(4) interface and using the standard pci(4) bus driver on
top. - Memory and bus numbers resource management was rewritten to
properly handle resource requests using memory windows of the VMD
device. - Interrupt handling was completely rewritten to distribute
child interrupts among available VMD MSI-X vectors, setting them up to
be handled via standard OS mechanisms with minimal overhead instead of
custom dispatching via taskqueue. Due to the limited number of vectors
and routing abilities of VMD, children are limited to only one MSI or
three MSI-X vectors per device to avoid sharing. The limits can be
tuned, depending on the number of VMD vectors and children. To improve
the flexibility the nvme(4) driver was made to work with a limited
number of vectors, starting from just one MSI/MSI-X if needed.

Sponsor: iXsystems, Inc.

------------------------------------------------------------------------

Last modified on: November 15, 2021 by Daniel Ebdrup Jensen

Legal Notices | © 1995-2023 The FreeBSD Project All rights reserved. The
mark FreeBSD is a registered trademark of The FreeBSD Foundation and is
used by The FreeBSD Project with the permission of The FreeBSD
Foundation. Contact
>>>>>>> b1bb5fd9 (Processing txt files in data/doc)
